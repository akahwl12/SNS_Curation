{"remainingRequest":"C:\\Users\\multicampus\\Desktop\\Sub PJT III\\s02p12b103\\fooddeuk\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\multicampus\\Desktop\\Sub PJT III\\s02p12b103\\fooddeuk\\front\\src\\components\\common\\Alarm.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\multicampus\\Desktop\\Sub PJT III\\s02p12b103\\fooddeuk\\front\\src\\components\\common\\Alarm.vue","mtime":1580804908423},{"path":"C:\\Users\\multicampus\\Desktop\\Sub PJT III\\s02p12b103\\fooddeuk\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\multicampus\\Desktop\\Sub PJT III\\s02p12b103\\fooddeuk\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\multicampus\\Desktop\\Sub PJT III\\s02p12b103\\fooddeuk\\front\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\multicampus\\Desktop\\Sub PJT III\\s02p12b103\\fooddeuk\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\multicampus\\Desktop\\Sub PJT III\\s02p12b103\\fooddeuk\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7bWFwU3RhdGV9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgaHR0cCBmcm9tICcuLi8uLi8uLi9odHRwLWNvbW1vbicKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnCmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JwppbXBvcnQgVnVlTW9tZW50SlMgZnJvbSAndnVlLW1vbWVudGpzJwppbXBvcnQge2ZpcmVEQn0gZnJvbSAnLi4vLi4vbWFpbicKClZ1ZS51c2UoVnVlTW9tZW50SlMsIG1vbWVudCkKCi8vIHRoaXMuZ2V0QWxhcm1Gcm9tRmlyZWJhc2UoKTsKCgpleHBvcnQgZGVmYXVsdCB7CiAgY3JlYXRlZCgpIHsKICAgIG1vbWVudC5sb2NhbGUoJ2tvJyk7CiAgICBpZih0aGlzLiRzdG9yZS5zdGF0ZS51c2VyaW5mbyE9bnVsbCkgewogICAgICB0aGlzLmVtYWlsID0gdGhpcy4kc3RvcmUuc3RhdGUudXNlcmluZm8uZW1haWw7CiAgICAgIHRoaXMubmlja25hbWUgPSB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyaW5mby5uaWNrTmFtZTsKICAgIH0KICAgIHRoaXMuZ2V0QWxhcm1zKCk7CiAgfSwKICB3YXRjaDogewogICAgaXRlbVNpemUgOiBmdW5jdGlvbiAodikgewogICAgICB0aGlzLmdldEFsYXJtRnJvbUZpcmViYXNlKCk7CiAgICB9CiAgfSwKICBtZXRob2RzIDogewogICAgZ2V0QWxhcm1Gcm9tRmlyZWJhc2UoKSB7CiAgICAgIC8vIHZhciBhbGFybUNvdW50UmVmID0gZmlyZURCLmNvbGxlY3Rpb24odGhpcy5lbWFpbCkuYWRkKHsKICAgICAgLy8gICBhbGFybSA6IDIsCiAgICAgIC8vICAgcmVxdWVzdCA6IDMKICAgICAgLy8gfSkudGhlbihmdW5jdGlvbihkb2NSZWYpIHsKICAgICAgLy8gICBjb25zb2xlLmxvZygiRG9jdW1lbnQgd3JpdHRlbiB3aXRoIElEOiAiLCBkb2NSZWYuaWQpOwogICAgICAvLyB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikgewogICAgICAvLyAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGFkZGluZyBkb2N1bWVudDogIiwgZXJyb3IpOwogICAgICAvLyB9KTsKCiAgICAgIGZpcmVEQi5jb2xsZWN0aW9uKCdBbGFybScpLmRvYyh0aGlzLmVtYWlsKS5nZXQoKS5vblNuYXBzaG90KGZ1bmN0aW9uKGRvYykgewogICAgICAgICAgY29uc29sZS5sb2coIkN1cnJlbnQgZGF0YTogIiwgZG9jLmRhdGEoKSk7CiAgICAgIH0pOwogICAgICAKICAgIH0sCiAgICBjb25maXJtQWxhcm0obnVtKSB7CiAgICAgIGh0dHAucGF0Y2goIi9mb2xsb3cvYWxhcm1jb25maXJtP251bT0iICsgbnVtKQogICAgICAudGhlbihSZXNwb25zZSA9PiB7CiAgICAgICAgdGhpcy5pdGVtcyA9IFJlc3BvbnNlLmRhdGEKICAgICAgICBjb25zb2xlLmxvZyhSZXNwb25zZS5kYXRhKQogICAgICAgIHRoaXMuZ2V0QWxhcm1zKCkKICAgICAgfSkKICAgICAgLmNhdGNoKEVycm9yID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKEVycm9yKQogICAgICB9KQogICAgfSwKICAgIGdldFRpbWUodGltZSkgewogICAgICByZXR1cm4gbW9tZW50KHRpbWUpLmZyb21Ob3coKTsKICAgIH0sCiAgICBnZXRBbGFybXMoKSB7CiAgICAgIGh0dHAuZ2V0KCIvZm9sbG93L2FsYXJtbGlzdD9teW5pY2tuYW1lPSIgKyB0aGlzLm5pY2tuYW1lKQogICAgICAudGhlbihSZXNwb25zZSA9PiB7CiAgICAgICAgdGhpcy5pdGVtcyA9IFJlc3BvbnNlLmRhdGEKICAgICAgICBjb25zb2xlLmxvZyhSZXNwb25zZS5kYXRhKQogICAgICB9KQogICAgICAuY2F0Y2goRXJyb3IgPT4gewogICAgICAgICAgY29uc29sZS5sb2coRXJyb3IpCiAgICAgIH0pCiAgICB9LAogICAgYWNjZXB0KG51bSwgb3RoZXJOaWNrbmFtZSkgewogICAgICBsZXQgZm9ybSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAgIAogICAgICBmb3JtLmFwcGVuZCgnbmlja25hbWUnLCB0aGlzLm5pY2tuYW1lKQogICAgICBmb3JtLmFwcGVuZCgnbXluaWNrbmFtZScsIG90aGVyTmlja25hbWUpCiAgICAgIGh0dHAucG9zdCgiL2ZvbGxvdy9mb2xsb3dhZ3JlZSIsIGZvcm0pCiAgICAgIC50aGVuKFJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLmlzZm9sbG93ID0gMTsKICAgICAgICBjb25zb2xlLmxvZyhSZXNwb25zZS5kYXRhKQogICAgICAgIHRoaXMuZ2V0QWxhcm1zKCk7CiAgICAgIH0pCiAgICAgIC5jYXRjaChFcnJvciA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhFcnJvcikKICAgICAgfSkKICAgIH0sCiAgfSwKICBkYXRhOiAoKSA9PiAoewogICAgZW1haWwgOiAnJywKICAgIG5pY2tuYW1lOiAnJywKICAgIGl0ZW1zOiBbXSwKICAgIGl0ZW1TaXplOiAwLAogIH0pLAogIGNvbXB1dGVkIDogewogICAgICAuLi5tYXBTdGF0ZShbJ3VzZXJpbmZvJ10pLAogIH0KfQo="},{"version":3,"sources":["Alarm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyCA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Alarm.vue","sourceRoot":"src/components/common","sourcesContent":["<template>\r\n  <v-card\r\n    class=\"mx-auto\"\r\n  >\r\n\r\n    <v-list three-line>\r\n      <template v-for=\"(item, index) in items\">\r\n        <v-subheader\r\n          v-if=\"item.header\"\r\n          :key=\"item.header\"\r\n          v-text=\"item.header\"\r\n        ></v-subheader>\r\n        \r\n\r\n        <v-divider\r\n          v-else-if=\"item.divider\"\r\n          :key=\"index\"\r\n          :inset=\"item.inset\"\r\n        ></v-divider>\r\n\r\n        <v-list-item\r\n          v-else\r\n          :key=\"item.title\"\r\n        >\r\n          <v-list-item-avatar>\r\n            <v-img :src=\"item.avatar\"></v-img>\r\n          </v-list-item-avatar>\r\n\r\n          <v-list-item-content @click=\"confirmAlarm(item.num)\">\r\n            <v-list-item-title v-if=\"item.reason==2\">\"{{item.sender}}\"님이 회원님을 팔로우했습니다.</v-list-item-title>\r\n            <v-list-item-title v-if=\"item.reason==3\">\"{{item.sender}}\"님이 팔로우신청을 거절했습니다.</v-list-item-title>\r\n            <v-list-item-title v-if=\"item.reason==4\">\"{{item.sender}}\"님이 회원님의 피드에 좋아요를 눌렀습니다.</v-list-item-title>\r\n            <v-list-item-subtitle>{{getTime(item.date)}}</v-list-item-subtitle>\r\n          </v-list-item-content>\r\n        </v-list-item>\r\n      </template>\r\n    </v-list>\r\n  </v-card>\r\n</template>\r\n\r\n<script>\r\n  import {mapState} from 'vuex';\r\n  import http from '../../../http-common'\r\n  import Vue from 'vue'\r\n  import moment from 'moment'\r\n  import VueMomentJS from 'vue-momentjs'\r\n  import {fireDB} from '../../main'\r\n\r\n  Vue.use(VueMomentJS, moment)\r\n\r\n  // this.getAlarmFromFirebase();\r\n\r\n\r\n  export default {\r\n    created() {\r\n      moment.locale('ko');\r\n      if(this.$store.state.userinfo!=null) {\r\n        this.email = this.$store.state.userinfo.email;\r\n        this.nickname = this.$store.state.userinfo.nickName;\r\n      }\r\n      this.getAlarms();\r\n    },\r\n    watch: {\r\n      itemSize : function (v) {\r\n        this.getAlarmFromFirebase();\r\n      }\r\n    },\r\n    methods : {\r\n      getAlarmFromFirebase() {\r\n        // var alarmCountRef = fireDB.collection(this.email).add({\r\n        //   alarm : 2,\r\n        //   request : 3\r\n        // }).then(function(docRef) {\r\n        //   console.log(\"Document written with ID: \", docRef.id);\r\n        // }).catch(function(error) {\r\n        //   console.error(\"Error adding document: \", error);\r\n        // });\r\n\r\n        fireDB.collection('Alarm').doc(this.email).get().onSnapshot(function(doc) {\r\n            console.log(\"Current data: \", doc.data());\r\n        });\r\n        \r\n      },\r\n      confirmAlarm(num) {\r\n        http.patch(\"/follow/alarmconfirm?num=\" + num)\r\n        .then(Response => {\r\n          this.items = Response.data\r\n          console.log(Response.data)\r\n          this.getAlarms()\r\n        })\r\n        .catch(Error => {\r\n            console.log(Error)\r\n        })\r\n      },\r\n      getTime(time) {\r\n        return moment(time).fromNow();\r\n      },\r\n      getAlarms() {\r\n        http.get(\"/follow/alarmlist?mynickname=\" + this.nickname)\r\n        .then(Response => {\r\n          this.items = Response.data\r\n          console.log(Response.data)\r\n        })\r\n        .catch(Error => {\r\n            console.log(Error)\r\n        })\r\n      },\r\n      accept(num, otherNickname) {\r\n        let form = new FormData();\r\n          \r\n        form.append('nickname', this.nickname)\r\n        form.append('mynickname', otherNickname)\r\n        http.post(\"/follow/followagree\", form)\r\n        .then(Response => {\r\n          this.isfollow = 1;\r\n          console.log(Response.data)\r\n          this.getAlarms();\r\n        })\r\n        .catch(Error => {\r\n            console.log(Error)\r\n        })\r\n      },\r\n    },\r\n    data: () => ({\r\n      email : '',\r\n      nickname: '',\r\n      items: [],\r\n      itemSize: 0,\r\n    }),\r\n    computed : {\r\n        ...mapState(['userinfo']),\r\n    }\r\n  }\r\n</script>"]}]}