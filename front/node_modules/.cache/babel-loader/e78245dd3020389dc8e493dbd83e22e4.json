{"remainingRequest":"C:\\Users\\multicampus\\Desktop\\Sub PJT II\\s02p12b103\\fooddeuk\\front\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\multicampus\\Desktop\\Sub PJT II\\s02p12b103\\fooddeuk\\front\\node_modules\\vuetify-loader\\lib\\loader.js??ref--18-0!C:\\Users\\multicampus\\Desktop\\Sub PJT II\\s02p12b103\\fooddeuk\\front\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\multicampus\\Desktop\\Sub PJT II\\s02p12b103\\fooddeuk\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\multicampus\\Desktop\\Sub PJT II\\s02p12b103\\fooddeuk\\front\\src\\components\\common\\Alarm.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\multicampus\\Desktop\\Sub PJT II\\s02p12b103\\fooddeuk\\front\\src\\components\\common\\Alarm.vue","mtime":1581295673422},{"path":"C:\\Users\\multicampus\\Desktop\\Sub PJT II\\s02p12b103\\fooddeuk\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\multicampus\\Desktop\\Sub PJT II\\s02p12b103\\fooddeuk\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\multicampus\\Desktop\\Sub PJT II\\s02p12b103\\fooddeuk\\front\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\multicampus\\Desktop\\Sub PJT II\\s02p12b103\\fooddeuk\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\multicampus\\Desktop\\Sub PJT II\\s02p12b103\\fooddeuk\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcnMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giOwppbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gIkM6XFxVc2Vyc1xcbXVsdGljYW1wdXNcXERlc2t0b3BcXFN1YiBQSlQgSUlcXHMwMnAxMmIxMDNcXGZvb2RkZXVrXFxmcm9udFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkiOwoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfQoKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgbWFwU3RhdGUgfSBmcm9tICd2dWV4JzsKaW1wb3J0IGh0dHAgZnJvbSAnLi4vLi4vLi4vaHR0cC1jb21tb24nOwppbXBvcnQgVnVlIGZyb20gJ3Z1ZSc7CmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JzsKaW1wb3J0IFZ1ZU1vbWVudEpTIGZyb20gJ3Z1ZS1tb21lbnRqcyc7CmltcG9ydCB7IGZpcmVEQiB9IGZyb20gJy4uLy4uL21haW4nOwppbXBvcnQgRXZlbnRCdXMgZnJvbSAnLi4vLi4vRXZlbnRCdXMnOwpWdWUudXNlKFZ1ZU1vbWVudEpTLCBtb21lbnQpOyAvLyB0aGlzLmdldEFsYXJtRnJvbUZpcmViYXNlKCk7CgpleHBvcnQgZGVmYXVsdCB7CiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIG1vbWVudC5sb2NhbGUoJ2tvJyk7CgogICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJpbmZvICE9IG51bGwpIHsKICAgICAgdGhpcy5lbWFpbCA9IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJpbmZvLmVtYWlsOwogICAgICB0aGlzLm5pY2tuYW1lID0gdGhpcy4kc3RvcmUuc3RhdGUudXNlcmluZm8ubmlja05hbWU7CiAgICB9IC8vIHRoaXMuZ2V0QWxhcm1zKCk7CgoKICAgIHRoaXMud2F0Y2hBbGFybUZyb21GaXJlYmFzZSgpOwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHRoaXMuZW1pdEFsYXJtKCk7CiAgfSwKICB3YXRjaDoge30sCiAgbWV0aG9kczogewogICAgZW1pdEFsYXJtOiBmdW5jdGlvbiBlbWl0QWxhcm0oKSB7CiAgICAgIHZhciB3aG9hbWkgPSB0aGlzOwogICAgICBFdmVudEJ1cy4kb24oJ2VtaXRBbGFybScsIGZ1bmN0aW9uICgpIHsKICAgICAgICAvLyBhbGVydCgiZW1pdEFsYXJtIOqwkOyngCIpCiAgICAgICAgd2hvYW1pLmdldEFsYXJtcygpOwogICAgICB9KTsKICAgIH0sCiAgICBzZXRBbGFybTogZnVuY3Rpb24gc2V0QWxhcm0oYWxhcm0pIHsKICAgICAgdGhpcy5hbGFybUNvdW50ID0gYWxhcm07CiAgICB9LAogICAgdXBkYXRlQWxhcm1Ub0ZpcmViYXNlOiBmdW5jdGlvbiB1cGRhdGVBbGFybVRvRmlyZWJhc2UoKSB7CiAgICAgIGZpcmVEQi5jb2xsZWN0aW9uKCdBbGFybScpLmRvYyh0aGlzLmVtYWlsKS5zZXQoewogICAgICAgIGNvdW50OiB0aGlzLmFsYXJtQ291bnQgLSAxCiAgICAgIH0pOwogICAgfSwKICAgIHdhdGNoQWxhcm1Gcm9tRmlyZWJhc2U6IGZ1bmN0aW9uIHdhdGNoQWxhcm1Gcm9tRmlyZWJhc2UoKSB7CiAgICAgIHZhciB3aG9hbWkgPSB0aGlzOwogICAgICB2YXIgY291bnQgPSAwOwogICAgICBmaXJlREIuY29sbGVjdGlvbignQWxhcm0nKS5kb2ModGhpcy5lbWFpbCkub25TbmFwc2hvdCh7CiAgICAgICAgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczogdHJ1ZQogICAgICB9LCBmdW5jdGlvbiAoZG9jKSB7CiAgICAgICAgaWYgKGRvYy5kYXRhKCkgPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBjb3VudCA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvdW50ID0gZG9jLmRhdGEoKS5jb3VudDsKICAgICAgICB9CgogICAgICAgIHdob2FtaS5zZXRBbGFybShjb3VudCk7CiAgICAgICAgd2hvYW1pLmdldEFsYXJtcygpOwogICAgICB9KTsKICAgIH0sCiAgICBjb25maXJtQWxhcm06IGZ1bmN0aW9uIGNvbmZpcm1BbGFybShudW0pIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGh0dHAucGF0Y2goIi9mb2xsb3cvYWxhcm1jb25maXJtP251bT0iICsgbnVtKS50aGVuKGZ1bmN0aW9uIChSZXNwb25zZSkgewogICAgICAgIF90aGlzLml0ZW1zID0gUmVzcG9uc2UuZGF0YTsgLy8gY29uc29sZS5sb2coUmVzcG9uc2UuZGF0YSkKCiAgICAgICAgX3RoaXMuZ2V0QWxhcm1zKCk7CgogICAgICAgIF90aGlzLnVwZGF0ZUFsYXJtVG9GaXJlYmFzZSgpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoRXJyb3IpIHsKICAgICAgICBjb25zb2xlLmxvZyhFcnJvcik7CiAgICAgIH0pOwogICAgfSwKICAgIGdldFRpbWU6IGZ1bmN0aW9uIGdldFRpbWUodGltZSkgewogICAgICByZXR1cm4gbW9tZW50KHRpbWUpLmZyb21Ob3coKTsKICAgIH0sCiAgICBnZXRBbGFybXM6IGZ1bmN0aW9uIGdldEFsYXJtcygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBodHRwLmdldCgiL2ZvbGxvdy9hbGFybWxpc3Q/bXluaWNrbmFtZT0iICsgdGhpcy5uaWNrbmFtZSkudGhlbihmdW5jdGlvbiAoUmVzcG9uc2UpIHsKICAgICAgICBfdGhpczIuaXRlbXMgPSBSZXNwb25zZS5kYXRhOyAvLyBjb25zb2xlLmxvZyhSZXNwb25zZS5kYXRhKQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoRXJyb3IpIHsKICAgICAgICBjb25zb2xlLmxvZyhFcnJvcik7CiAgICAgIH0pOwogICAgfQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGVtYWlsOiAnJywKICAgICAgbmlja25hbWU6ICcnLAogICAgICBpdGVtczogW10sCiAgICAgIGFsYXJtQ291bnQ6IDAKICAgIH07CiAgfSwKICBjb21wdXRlZDogX29iamVjdFNwcmVhZCh7fSwgbWFwU3RhdGUoWyd1c2VyaW5mbyddKSkKfTs="},{"version":3,"sources":["Alarm.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <v-card\r\n    class=\"mx-auto\"\r\n  >\r\n    <div v-if=\"items.length==0\">\r\n      알림이 없습니다.\r\n    </div>\r\n    <v-list v-if=\"items.length!=0\" three-line>\r\n      <template v-for=\"(item, index) in items\">\r\n        <v-subheader\r\n          v-if=\"item.header\"\r\n          :key=\"item.header\"\r\n          v-text=\"item.header\"\r\n        ></v-subheader>\r\n        \r\n\r\n        <v-divider\r\n          v-else-if=\"item.divider\"\r\n          :key=\"index\"\r\n          :inset=\"item.inset\"\r\n        ></v-divider>\r\n\r\n        <v-list-item\r\n          v-else\r\n          :key=\"item.title\"\r\n        >\r\n          <v-list-item-avatar>\r\n            <v-img :src=\"item.avatar\"></v-img>\r\n          </v-list-item-avatar>\r\n\r\n          <v-list-item-content @click=\"confirmAlarm(item.num)\">\r\n            <v-list-item-title v-if=\"item.reason==2\">\"{{item.sender}}\"님이 회원님을 팔로우했습니다.</v-list-item-title>\r\n            <v-list-item-title v-if=\"item.reason==3\">\"{{item.sender}}\"님이 팔로우신청을 거절했습니다.</v-list-item-title>\r\n            <v-list-item-title v-if=\"item.reason==4\">\"{{item.sender}}\"님이 회원님의 피드에 좋아요를 눌렀습니다.</v-list-item-title>\r\n            <v-list-item-subtitle>{{getTime(item.date)}}</v-list-item-subtitle>\r\n          </v-list-item-content>\r\n        </v-list-item>\r\n      </template>\r\n    </v-list>\r\n  </v-card>\r\n</template>\r\n\r\n<script>\r\n  import {mapState} from 'vuex';\r\n  import http from '../../../http-common'\r\n  import Vue from 'vue'\r\n  import moment from 'moment'\r\n  import VueMomentJS from 'vue-momentjs'\r\n  import {fireDB} from '../../main'\r\n  import EventBus from '../../EventBus'\r\n\r\n  Vue.use(VueMomentJS, moment)\r\n\r\n  // this.getAlarmFromFirebase();\r\n\r\n\r\n  export default {\r\n    created() {\r\n      moment.locale('ko');\r\n      if(this.$store.state.userinfo!=null) {\r\n        this.email = this.$store.state.userinfo.email;\r\n        this.nickname = this.$store.state.userinfo.nickName;\r\n      }\r\n      // this.getAlarms();\r\n      this.watchAlarmFromFirebase();\r\n    },\r\n    mounted : function() {\r\n      this.emitAlarm();\r\n    },\r\n    watch: {\r\n    },\r\n    methods : {\r\n      \r\n      emitAlarm() {\r\n        let whoami = this;\r\n        EventBus.$on('emitAlarm', function() {\r\n          // alert(\"emitAlarm 감지\")\r\n          whoami.getAlarms();\r\n        })\r\n      },\r\n      setAlarm(alarm) {\r\n        this.alarmCount = alarm;\r\n      },\r\n      updateAlarmToFirebase() {\r\n        fireDB.collection('Alarm').doc(this.email)\r\n        .set({\r\n          count : this.alarmCount - 1\r\n        })\r\n      },\r\n      watchAlarmFromFirebase() {\r\n        let whoami = this;\r\n        let count=0;\r\n        fireDB.collection('Alarm').doc(this.email).onSnapshot( {\r\n            includeMetadataChanges: true    \r\n        },function(doc) {\r\n            if(doc.data()==undefined) {\r\n                count = 0;\r\n            } else {\r\n                count = doc.data().count;\r\n            }\r\n            whoami.setAlarm(count);\r\n            whoami.getAlarms();\r\n        })\r\n      },\r\n      confirmAlarm(num) {\r\n        http.patch(\"/follow/alarmconfirm?num=\" + num)\r\n        .then(Response => {\r\n          this.items = Response.data\r\n          // console.log(Response.data)\r\n          this.getAlarms()\r\n          this.updateAlarmToFirebase();\r\n        })\r\n        .catch(Error => {\r\n            console.log(Error)\r\n        })\r\n      },\r\n      getTime(time) {\r\n        return moment(time).fromNow();\r\n      },\r\n      getAlarms() {\r\n        http.get(\"/follow/alarmlist?mynickname=\" + this.nickname)\r\n        .then(Response => {\r\n          this.items = Response.data\r\n          // console.log(Response.data)\r\n        })\r\n        .catch(Error => {\r\n            console.log(Error)\r\n        })\r\n      },\r\n    },\r\n    data: () => ({\r\n      email : '',\r\n      nickname: '',\r\n      items: [],\r\n      alarmCount: 0,\r\n    }),\r\n    computed : {\r\n        ...mapState(['userinfo']),\r\n    }\r\n  }\r\n</script>"],"sourceRoot":"src/components/common"}]}